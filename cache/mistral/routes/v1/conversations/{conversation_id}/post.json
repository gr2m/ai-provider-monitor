{
  "description": "Run completion on the history of the conversation and the user entries. Return the new created entries.",
  "operationId": "agents_api_v1_conversations_append",
  "parameters": [
    {
      "description": "ID of the conversation to which we append entries.",
      "in": "path",
      "name": "conversation_id",
      "required": true,
      "schema": {
        "description": "ID of the conversation to which we append entries.",
        "title": "Conversation Id",
        "type": "string"
      }
    }
  ],
  "requestBody": {
    "content": {
      "application/json": {
        "schema": {
          "$ref": "#/components/schemas/ConversationAppendRequest"
        }
      }
    },
    "required": true
  },
  "responses": {
    "200": {
      "content": {
        "application/json": {
          "schema": {
            "$ref": "#/components/schemas/ConversationResponse"
          }
        }
      },
      "description": "Successful Response"
    },
    "422": {
      "content": {
        "application/json": {
          "schema": {
            "$ref": "#/components/schemas/HTTPValidationError"
          }
        }
      },
      "description": "Validation Error"
    }
  },
  "summary": "Append new entries to an existing conversation.",
  "tags": [
    "beta.conversations"
  ],
  "components": {
    "schemas": {
      "ConversationAppendRequest": {
        "allOf": [
          {
            "$ref": "#/components/schemas/ConversationAppendRequestBase"
          },
          {
            "properties": {
              "stream": {
                "default": false,
                "enum": [
                  false
                ],
                "type": "boolean"
              }
            },
            "type": "object"
          }
        ]
      },
      "ConversationResponse": {
        "additionalProperties": false,
        "description": "The response after appending new entries to the conversation.",
        "properties": {
          "conversation_id": {
            "title": "Conversation Id",
            "type": "string"
          },
          "object": {
            "default": "conversation.response",
            "enum": [
              "conversation.response"
            ],
            "title": "Object",
            "type": "string"
          },
          "outputs": {
            "items": {
              "anyOf": [
                {
                  "$ref": "#/components/schemas/MessageOutputEntry"
                },
                {
                  "$ref": "#/components/schemas/ToolExecutionEntry"
                },
                {
                  "$ref": "#/components/schemas/FunctionCallEntry"
                },
                {
                  "$ref": "#/components/schemas/AgentHandoffEntry"
                }
              ]
            },
            "title": "Outputs",
            "type": "array"
          },
          "usage": {
            "$ref": "#/components/schemas/ConversationUsageInfo"
          }
        },
        "required": [
          "conversation_id",
          "outputs",
          "usage"
        ],
        "title": "ConversationResponse",
        "type": "object"
      },
      "HTTPValidationError": {
        "properties": {
          "detail": {
            "items": {
              "$ref": "#/components/schemas/ValidationError"
            },
            "title": "Detail",
            "type": "array"
          }
        },
        "title": "HTTPValidationError",
        "type": "object"
      },
      "ConversationAppendRequestBase": {
        "additionalProperties": false,
        "properties": {
          "completion_args": {
            "$ref": "#/components/schemas/CompletionArgs",
            "description": "Completion arguments that will be used to generate assistant responses. Can be overridden at each message request."
          },
          "handoff_execution": {
            "default": "server",
            "enum": [
              "client",
              "server"
            ],
            "title": "Handoff Execution",
            "type": "string"
          },
          "inputs": {
            "$ref": "#/components/schemas/ConversationInputs"
          },
          "store": {
            "default": true,
            "description": "Whether to store the results into our servers or not.",
            "title": "Store",
            "type": "boolean"
          },
          "stream": {
            "default": false,
            "description": "Whether to stream back partial progress. Otherwise, the server will hold the request open until the timeout or until completion, with the response containing the full result as JSON.",
            "title": "Stream",
            "type": "boolean"
          }
        },
        "required": [
          "inputs"
        ],
        "title": "ConversationAppendRequest",
        "type": "object"
      },
      "MessageOutputEntry": {
        "additionalProperties": false,
        "properties": {
          "agent_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Agent Id"
          },
          "completed_at": {
            "anyOf": [
              {
                "format": "date-time",
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Completed At"
          },
          "content": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "$ref": "#/components/schemas/MessageOutputContentChunks"
              }
            ],
            "title": "Content"
          },
          "created_at": {
            "format": "date-time",
            "title": "Created At",
            "type": "string"
          },
          "id": {
            "title": "Id",
            "type": "string"
          },
          "model": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Model"
          },
          "object": {
            "default": "entry",
            "enum": [
              "entry"
            ],
            "title": "Object",
            "type": "string"
          },
          "role": {
            "default": "assistant",
            "enum": [
              "assistant"
            ],
            "title": "Role",
            "type": "string"
          },
          "type": {
            "default": "message.output",
            "enum": [
              "message.output"
            ],
            "title": "Type",
            "type": "string"
          }
        },
        "required": [
          "content"
        ],
        "title": "MessageOutputEntry",
        "type": "object"
      },
      "ToolExecutionEntry": {
        "additionalProperties": false,
        "properties": {
          "arguments": {
            "title": "Arguments",
            "type": "string"
          },
          "completed_at": {
            "anyOf": [
              {
                "format": "date-time",
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Completed At"
          },
          "created_at": {
            "format": "date-time",
            "title": "Created At",
            "type": "string"
          },
          "id": {
            "title": "Id",
            "type": "string"
          },
          "info": {
            "$ref": "#/components/schemas/ToolExecutionInfo"
          },
          "name": {
            "anyOf": [
              {
                "$ref": "#/components/schemas/BuiltInConnectors"
              },
              {
                "type": "string"
              }
            ],
            "title": "Name"
          },
          "object": {
            "default": "entry",
            "enum": [
              "entry"
            ],
            "title": "Object",
            "type": "string"
          },
          "type": {
            "default": "tool.execution",
            "enum": [
              "tool.execution"
            ],
            "title": "Type",
            "type": "string"
          }
        },
        "required": [
          "name",
          "arguments"
        ],
        "title": "ToolExecutionEntry",
        "type": "object"
      },
      "FunctionCallEntry": {
        "additionalProperties": false,
        "properties": {
          "arguments": {
            "$ref": "#/components/schemas/FunctionCallEntryArguments"
          },
          "completed_at": {
            "anyOf": [
              {
                "format": "date-time",
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Completed At"
          },
          "created_at": {
            "format": "date-time",
            "title": "Created At",
            "type": "string"
          },
          "id": {
            "title": "Id",
            "type": "string"
          },
          "name": {
            "title": "Name",
            "type": "string"
          },
          "object": {
            "default": "entry",
            "enum": [
              "entry"
            ],
            "title": "Object",
            "type": "string"
          },
          "tool_call_id": {
            "title": "Tool Call Id",
            "type": "string"
          },
          "type": {
            "default": "function.call",
            "enum": [
              "function.call"
            ],
            "title": "Type",
            "type": "string"
          }
        },
        "required": [
          "tool_call_id",
          "name",
          "arguments"
        ],
        "title": "FunctionCallEntry",
        "type": "object"
      },
      "AgentHandoffEntry": {
        "additionalProperties": false,
        "properties": {
          "completed_at": {
            "anyOf": [
              {
                "format": "date-time",
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Completed At"
          },
          "created_at": {
            "format": "date-time",
            "title": "Created At",
            "type": "string"
          },
          "id": {
            "title": "Id",
            "type": "string"
          },
          "next_agent_id": {
            "title": "Next Agent Id",
            "type": "string"
          },
          "next_agent_name": {
            "title": "Next Agent Name",
            "type": "string"
          },
          "object": {
            "default": "entry",
            "enum": [
              "entry"
            ],
            "title": "Object",
            "type": "string"
          },
          "previous_agent_id": {
            "title": "Previous Agent Id",
            "type": "string"
          },
          "previous_agent_name": {
            "title": "Previous Agent Name",
            "type": "string"
          },
          "type": {
            "default": "agent.handoff",
            "enum": [
              "agent.handoff"
            ],
            "title": "Type",
            "type": "string"
          }
        },
        "required": [
          "previous_agent_id",
          "previous_agent_name",
          "next_agent_id",
          "next_agent_name"
        ],
        "title": "AgentHandoffEntry",
        "type": "object"
      },
      "ConversationUsageInfo": {
        "additionalProperties": false,
        "properties": {
          "completion_tokens": {
            "default": 0,
            "title": "Completion Tokens",
            "type": "integer"
          },
          "connector_tokens": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "default": null,
            "title": "Connector Tokens"
          },
          "connectors": {
            "anyOf": [
              {
                "additionalProperties": {
                  "type": "integer"
                },
                "type": "object"
              },
              {
                "type": "null"
              }
            ],
            "default": null,
            "title": "Connectors"
          },
          "prompt_tokens": {
            "default": 0,
            "title": "Prompt Tokens",
            "type": "integer"
          },
          "total_tokens": {
            "default": 0,
            "title": "Total Tokens",
            "type": "integer"
          }
        },
        "title": "ConversationUsageInfo",
        "type": "object"
      },
      "ValidationError": {
        "properties": {
          "loc": {
            "items": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "integer"
                }
              ]
            },
            "title": "Location",
            "type": "array"
          },
          "msg": {
            "title": "Message",
            "type": "string"
          },
          "type": {
            "title": "Error Type",
            "type": "string"
          }
        },
        "required": [
          "loc",
          "msg",
          "type"
        ],
        "title": "ValidationError",
        "type": "object"
      },
      "CompletionArgs": {
        "additionalProperties": false,
        "description": "White-listed arguments from the completion API",
        "properties": {
          "frequency_penalty": {
            "anyOf": [
              {
                "maximum": 2,
                "minimum": -2,
                "type": "number"
              },
              {
                "type": "null"
              }
            ],
            "title": "Frequency Penalty"
          },
          "max_tokens": {
            "anyOf": [
              {
                "minimum": 0,
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Max Tokens"
          },
          "prediction": {
            "anyOf": [
              {
                "$ref": "#/components/schemas/Prediction"
              },
              {
                "type": "null"
              }
            ]
          },
          "presence_penalty": {
            "anyOf": [
              {
                "maximum": 2,
                "minimum": -2,
                "type": "number"
              },
              {
                "type": "null"
              }
            ],
            "title": "Presence Penalty"
          },
          "random_seed": {
            "anyOf": [
              {
                "minimum": 0,
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Random Seed"
          },
          "response_format": {
            "anyOf": [
              {
                "$ref": "#/components/schemas/ResponseFormat"
              },
              {
                "type": "null"
              }
            ]
          },
          "stop": {
            "$ref": "#/components/schemas/CompletionArgsStop"
          },
          "temperature": {
            "anyOf": [
              {
                "maximum": 1,
                "minimum": 0,
                "type": "number"
              },
              {
                "type": "null"
              }
            ],
            "title": "Temperature"
          },
          "tool_choice": {
            "$ref": "#/components/schemas/ToolChoiceEnum",
            "default": "auto"
          },
          "top_p": {
            "anyOf": [
              {
                "maximum": 1,
                "minimum": 0,
                "type": "number"
              },
              {
                "type": "null"
              }
            ],
            "title": "Top P"
          }
        },
        "title": "CompletionArgs",
        "type": "object"
      },
      "ConversationInputs": {
        "anyOf": [
          {
            "type": "string"
          },
          {
            "$ref": "#/components/schemas/InputEntries"
          }
        ],
        "title": "ConversationInputs"
      },
      "MessageOutputContentChunks": {
        "items": {
          "anyOf": [
            {
              "$ref": "#/components/schemas/TextChunk"
            },
            {
              "$ref": "#/components/schemas/ImageURLChunk"
            },
            {
              "$ref": "#/components/schemas/ToolFileChunk"
            },
            {
              "$ref": "#/components/schemas/DocumentURLChunk"
            },
            {
              "$ref": "#/components/schemas/ThinkChunk"
            },
            {
              "$ref": "#/components/schemas/ToolReferenceChunk"
            }
          ]
        },
        "title": "MessageOutputContentChunks",
        "type": "array"
      },
      "ToolExecutionInfo": {
        "additionalProperties": true,
        "title": "ToolExecutionInfo",
        "type": "object"
      },
      "BuiltInConnectors": {
        "enum": [
          "web_search",
          "web_search_premium",
          "code_interpreter",
          "image_generation",
          "document_library"
        ],
        "title": "BuiltInConnectors",
        "type": "string"
      },
      "FunctionCallEntryArguments": {
        "anyOf": [
          {
            "additionalProperties": true,
            "type": "object"
          },
          {
            "type": "string"
          }
        ],
        "title": "FunctionCallEntryArguments"
      },
      "Prediction": {
        "additionalProperties": false,
        "description": "Enable users to specify an expected completion, optimizing response times by leveraging known or predictable content.",
        "properties": {
          "content": {
            "default": "",
            "title": "Content",
            "type": "string"
          },
          "type": {
            "const": "content",
            "default": "content",
            "title": "Type",
            "type": "string"
          }
        },
        "title": "Prediction",
        "type": "object"
      },
      "ResponseFormat": {
        "additionalProperties": false,
        "description": "Specify the format that the model must output. By default it will use `{ \"type\": \"text\" }`. Setting to `{ \"type\": \"json_object\" }` enables JSON mode, which guarantees the message the model generates is in JSON. When using JSON mode you MUST also instruct the model to produce JSON yourself with a system or a user message. Setting to `{ \"type\": \"json_schema\" }` enables JSON schema mode, which guarantees the message the model generates is in JSON and follows the schema you provide.",
        "examples": [
          {
            "type": "text"
          },
          {
            "type": "json_object"
          },
          {
            "json_schema": {
              "name": "book",
              "schema": {
                "additionalProperties": false,
                "properties": {
                  "authors": {
                    "items": {
                      "type": "string"
                    },
                    "title": "Authors",
                    "type": "array"
                  },
                  "name": {
                    "title": "Name",
                    "type": "string"
                  }
                },
                "required": [
                  "name",
                  "authors"
                ],
                "title": "Book",
                "type": "object"
              },
              "strict": true
            },
            "type": "json_schema"
          }
        ],
        "properties": {
          "json_schema": {
            "anyOf": [
              {
                "$ref": "#/components/schemas/JsonSchema"
              },
              {
                "type": "null"
              }
            ]
          },
          "type": {
            "$ref": "#/components/schemas/ResponseFormats",
            "default": "text"
          }
        },
        "title": "ResponseFormat",
        "type": "object"
      },
      "CompletionArgsStop": {
        "anyOf": [
          {
            "type": "string"
          },
          {
            "items": {
              "type": "string"
            },
            "type": "array"
          },
          {
            "type": "null"
          }
        ],
        "title": "CompletionArgsStop"
      },
      "ToolChoiceEnum": {
        "enum": [
          "auto",
          "none",
          "any",
          "required"
        ],
        "title": "ToolChoiceEnum",
        "type": "string"
      },
      "InputEntries": {
        "items": {
          "anyOf": [
            {
              "$ref": "#/components/schemas/MessageInputEntry"
            },
            {
              "$ref": "#/components/schemas/MessageOutputEntry"
            },
            {
              "$ref": "#/components/schemas/FunctionResultEntry"
            },
            {
              "$ref": "#/components/schemas/FunctionCallEntry"
            },
            {
              "$ref": "#/components/schemas/ToolExecutionEntry"
            },
            {
              "$ref": "#/components/schemas/AgentHandoffEntry"
            }
          ]
        },
        "title": "InputEntries",
        "type": "array"
      },
      "TextChunk": {
        "additionalProperties": false,
        "properties": {
          "text": {
            "title": "Text",
            "type": "string"
          },
          "type": {
            "default": "text",
            "enum": [
              "text"
            ],
            "title": "Type",
            "type": "string"
          }
        },
        "required": [
          "text"
        ],
        "title": "TextChunk",
        "type": "object"
      },
      "ImageURLChunk": {
        "additionalProperties": false,
        "description": "{\"type\":\"image_url\",\"image_url\":{\"url\":\"data:image/png;base64,iVBORw0",
        "properties": {
          "image_url": {
            "anyOf": [
              {
                "$ref": "#/components/schemas/ImageURL"
              },
              {
                "type": "string"
              }
            ],
            "title": "Image Url"
          },
          "type": {
            "default": "image_url",
            "enum": [
              "image_url"
            ],
            "title": "Type",
            "type": "string"
          }
        },
        "required": [
          "image_url"
        ],
        "title": "ImageURLChunk",
        "type": "object"
      },
      "ToolFileChunk": {
        "additionalProperties": false,
        "properties": {
          "file_id": {
            "title": "File Id",
            "type": "string"
          },
          "file_name": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "File Name"
          },
          "file_type": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "File Type"
          },
          "tool": {
            "anyOf": [
              {
                "$ref": "#/components/schemas/BuiltInConnectors"
              },
              {
                "type": "string"
              }
            ],
            "title": "Tool"
          },
          "type": {
            "default": "tool_file",
            "enum": [
              "tool_file"
            ],
            "title": "Type",
            "type": "string"
          }
        },
        "required": [
          "tool",
          "file_id"
        ],
        "title": "ToolFileChunk",
        "type": "object"
      },
      "DocumentURLChunk": {
        "additionalProperties": false,
        "properties": {
          "document_name": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "description": "The filename of the document",
            "title": "Document Name"
          },
          "document_url": {
            "title": "Document Url",
            "type": "string"
          },
          "type": {
            "default": "document_url",
            "enum": [
              "document_url"
            ],
            "title": "Type",
            "type": "string"
          }
        },
        "required": [
          "document_url"
        ],
        "title": "DocumentURLChunk",
        "type": "object"
      },
      "ThinkChunk": {
        "additionalProperties": false,
        "properties": {
          "closed": {
            "default": true,
            "description": "Whether the thinking chunk is closed or not. Currently only used for prefixing.",
            "title": "Closed",
            "type": "boolean"
          },
          "thinking": {
            "items": {
              "anyOf": [
                {
                  "$ref": "#/components/schemas/ReferenceChunk"
                },
                {
                  "$ref": "#/components/schemas/TextChunk"
                }
              ]
            },
            "title": "Thinking",
            "type": "array"
          },
          "type": {
            "default": "thinking",
            "enum": [
              "thinking"
            ],
            "title": "Type",
            "type": "string"
          }
        },
        "required": [
          "thinking"
        ],
        "title": "ThinkChunk",
        "type": "object"
      },
      "ToolReferenceChunk": {
        "additionalProperties": false,
        "properties": {
          "description": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Description"
          },
          "favicon": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Favicon"
          },
          "title": {
            "title": "Title",
            "type": "string"
          },
          "tool": {
            "anyOf": [
              {
                "$ref": "#/components/schemas/BuiltInConnectors"
              },
              {
                "type": "string"
              }
            ],
            "title": "Tool"
          },
          "type": {
            "default": "tool_reference",
            "enum": [
              "tool_reference"
            ],
            "title": "Type",
            "type": "string"
          },
          "url": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Url"
          }
        },
        "required": [
          "tool",
          "title"
        ],
        "title": "ToolReferenceChunk",
        "type": "object"
      },
      "JsonSchema": {
        "additionalProperties": false,
        "properties": {
          "description": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Description"
          },
          "name": {
            "title": "Name",
            "type": "string"
          },
          "schema": {
            "additionalProperties": true,
            "title": "Schema",
            "type": "object"
          },
          "strict": {
            "default": false,
            "title": "Strict",
            "type": "boolean"
          }
        },
        "required": [
          "name",
          "schema"
        ],
        "title": "JsonSchema",
        "type": "object"
      },
      "ResponseFormats": {
        "enum": [
          "text",
          "json_object",
          "json_schema"
        ],
        "title": "ResponseFormats",
        "type": "string"
      },
      "MessageInputEntry": {
        "additionalProperties": false,
        "description": "Representation of an input message inside the conversation.",
        "properties": {
          "completed_at": {
            "anyOf": [
              {
                "format": "date-time",
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Completed At"
          },
          "content": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "$ref": "#/components/schemas/MessageInputContentChunks"
              }
            ],
            "title": "Content"
          },
          "created_at": {
            "format": "date-time",
            "title": "Created At",
            "type": "string"
          },
          "id": {
            "title": "Id",
            "type": "string"
          },
          "object": {
            "default": "entry",
            "enum": [
              "entry"
            ],
            "title": "Object",
            "type": "string"
          },
          "prefix": {
            "default": false,
            "title": "Prefix",
            "type": "boolean"
          },
          "role": {
            "enum": [
              "assistant",
              "user"
            ],
            "title": "Role",
            "type": "string"
          },
          "type": {
            "default": "message.input",
            "enum": [
              "message.input"
            ],
            "title": "Type",
            "type": "string"
          }
        },
        "required": [
          "role",
          "content"
        ],
        "title": "MessageInputEntry",
        "type": "object"
      },
      "FunctionResultEntry": {
        "additionalProperties": false,
        "properties": {
          "completed_at": {
            "anyOf": [
              {
                "format": "date-time",
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Completed At"
          },
          "created_at": {
            "format": "date-time",
            "title": "Created At",
            "type": "string"
          },
          "id": {
            "title": "Id",
            "type": "string"
          },
          "object": {
            "default": "entry",
            "enum": [
              "entry"
            ],
            "title": "Object",
            "type": "string"
          },
          "result": {
            "title": "Result",
            "type": "string"
          },
          "tool_call_id": {
            "title": "Tool Call Id",
            "type": "string"
          },
          "type": {
            "default": "function.result",
            "enum": [
              "function.result"
            ],
            "title": "Type",
            "type": "string"
          }
        },
        "required": [
          "tool_call_id",
          "result"
        ],
        "title": "FunctionResultEntry",
        "type": "object"
      },
      "ImageURL": {
        "additionalProperties": false,
        "properties": {
          "detail": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Detail"
          },
          "url": {
            "title": "Url",
            "type": "string"
          }
        },
        "required": [
          "url"
        ],
        "title": "ImageURL",
        "type": "object"
      },
      "ReferenceChunk": {
        "additionalProperties": false,
        "properties": {
          "reference_ids": {
            "items": {
              "type": "integer"
            },
            "title": "Reference Ids",
            "type": "array"
          },
          "type": {
            "default": "reference",
            "enum": [
              "reference"
            ],
            "title": "Type",
            "type": "string"
          }
        },
        "required": [
          "reference_ids"
        ],
        "title": "ReferenceChunk",
        "type": "object"
      },
      "MessageInputContentChunks": {
        "items": {
          "anyOf": [
            {
              "$ref": "#/components/schemas/TextChunk"
            },
            {
              "$ref": "#/components/schemas/ImageURLChunk"
            },
            {
              "$ref": "#/components/schemas/ToolFileChunk"
            },
            {
              "$ref": "#/components/schemas/DocumentURLChunk"
            },
            {
              "$ref": "#/components/schemas/ThinkChunk"
            }
          ]
        },
        "title": "MessageInputContentChunks",
        "type": "array"
      }
    }
  }
}
